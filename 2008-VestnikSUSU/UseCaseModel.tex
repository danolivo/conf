\documentclass[12pt,twoside]{article}
\usepackage{inputenc}
\usepackage[english,russian]{babel} %Windows
\usepackage{vestnik}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{graphicx}
\usepackage{cite}
\setcounter{page}{1}

\begin{document}
\def\Re{\mathop{\rm Re}\,}
\def\Im{\mathop{\rm Im}\,}
\def\dom{\mathop{\rm dom}\,}
\def\dist{\mathop{\rm dist}}
\def\grad{\mathop{\rm grad}}

\newcommand{\phan}{\hspace*{0cm}}
\newcommand{\comment}{}
\small{
\begin{flushleft}
\textbf{УДК 004.414.28}
\end{flushleft}}\vspace{10pt}
\author{А.В. Лепихов}
\title{МОДЕЛЬ ВАРИАНТОВ ИСПОЛЬЗОВАНИЯ ПАРАЛЛЕЛЬНОЙ СИСТЕМЫ УПРАВЛЕНИЯ БАЗАМИ ДАННЫХ ДЛЯ ГРИД}
\maketitle{}
% оформление аннотации
\begin{abstract} \begin{tabular}{p{20mm}p{119mm}}
&\noindent {\footnotesize \qquad Статья посвящена вопросам проектирования параллельных систем управления базами данных для грид-систем. Описаны общие требования и структура ПСУБД. Описана модель вариантов использования системы, приведены спецификации и диаграммы вариантов использования  подсистем "<Клиент"> и "<Координатор">.}
\end{tabular}\end{abstract}

\keywords{варианты использования, грид, система баз данных, параллельная обработка}

\markboth{А.В. Лепихов}{Модель вариантов использования ПСУБД}

\section*{Введение}
\parВ связи со значительным ростом хранимой в электронном виде информации, в настоящее время системы баз данных зачастую используются для управления петабайтами данных. Типичным примером таких сверхбольших баз данных являются научные базы данных, накапливающие информацию, поставляемую ускорителями элементарных частиц. Подобные базы данных могут эффективно поддерживаться и обрабатываться параллельными системами управления базами данных (ПСУБД).
\parПо этой причине в настоящее время одним из перспективных направлений в области параллельных систем баз данных является разработка систем управления базами данных для аппаратных платформ с многопроцессорной иерархической архитектурой и грид-систем. В такой системе процессорные устройства, память, диски и проч. связываются друг с другом в соответствии с некоторой иерархией. На первом уровне иерархии находятся процессорные ядра, размещенные на одном кристалле. На втором уровне находятся многоядерные процессоры, объединенные в многопроцессорные модули с общей памятью (SMP). На третьем уровне SMP-модули объединяются в кластер с помощью высокоскоростной соединительной сети. Четвертый уровень представляют грид-системы, включающие в себя несколько кластеров. Корпоративные грид-системы могут объединяться в кооперативные грид-объединения на базе Интернет.
\parПараллельным системам управления базами данных посвящено большое количество работ, обзор которых можно найти в~\cite{B_Gray2005, B_Mehta1997, B_Williams1998}. Однако проблематика систем баз данных для грид исследована мало.
\parЦелью настоящей статьи является описание спецификации ПСУБД ориентированной на использование в грид. Спецификация параллельной СУБД для грид разработана с учетом распределенного характера системы, неоднородности вычислительных узлов и коммуникационной сети. ПСУБД проектируется таким образом, чтобы изолировать пользователя от сложной структуры и технологий, лежащих в основе грид-системы. Требования к ПСУБД задаются при помощи модели вариантов использования~\cite{B_Rambaugh1994}, построенной на основе языка моделирования UML версии 2.0~\cite{B_Selic2006_UML2}.
\parСтатья организована следующим образом. 
В разделе~\ref{S_ParQueryProcessing} описан механизм обработки запросов в параллельных СУБД и рассмотрена проблема появления перекосов. Приведены основные требования, предъявляемые к разрабатываемой ПСУБД для грид-систем. В Разделе~\ref{S_PDBMSStructure} рассмотрена структура ПСУБД, дано описание подсистем "<Клиент">, "<Координатор"> и "<Ядро ПСУБД">. Приводится диаграмма состояний подсистемы "<Клиент">. Раздел~\ref{S_UseCaseModel} посвящен описанию вариантов использования ПСУБД. Специфицированы варианты использования подсистем "<Клиент"> и "<Координатор">, представлены диаграммы вариантов использования. В разделе~\ref{S_InOutData} дано описание форматов входных и выходных данных ПСУБД. В заключении суммируются основные полученные результаты.

\section{Организация параллельной обработки запросов}\label{S_ParQueryProcessing}
\subsection{Фрагментный параллелизм}
\parВопросам организации параллельной обработки запросов в многопроцессорных системах посвящен целый ряд работ (см.~\cite{B_Sokolinsky2001, B_Aloisio2005, B_Dutra2004}). Одной из основных форм параллельной обработки запросов является \textit{фрагментный параллелизм}. Фрагментный параллелизм предполагает \textit{фрагментацию} \---~разбиение на непересекающиеся части каждого отношения базы данных. Фрагменты отношения распределяются по различным процессорным узлам многопроцессорной системы. Основная идея заключается в том, чтобы преобразовать запрос в набор параллельных агентов, каждый из которых будет обрабатывать свою часть запроса на выделенном для него процессорном узле. При этом он будет использовать расположенный на данном узле фрагмент и (возможно) результаты работы других агентов. В работе~\cite{B_Sokolinsky2001}~преобразование запроса в набор параллельных агентов достигается путем вставки специального оператора \texttt{exchange}~в дерево запроса. Обработка запроса в таком случае происходит следующим образом~\cite{B_KostenetskyLS2007}.
Пусть система состоит из $n$ процессорных узлов. Запрос на языке SQL передается пользователем на host-машину, где он транслируется в некоторый \textit{последовательный физический план}. Данный физический план преобразуется в \textit{параллельный план}, представляющий собой совокупность параллельных агентов. Это достигается путем вставки параллельного оператора \texttt{exchange} в соответствующие места дерева запроса. Оператор \texttt{exchange} организует взаимодействие параллельных агентов и обеспечивает пересылку кортежей между агентами в тех случаях, когда это необходимо.
\parНа следующем этапе параллельные агенты пересылаются c host-машины на соответствующие процессорные узлы, где интерпретируются исполнителем запросов. Результаты выполнения агентов объединяются корневым оператором \texttt{exchange} на выделенном процессорном узле.

\subsection{Балансировка загрузки}
\parБольшое негативное влияние на производительность параллельных СУБД для многопроцессорных систем оказывает проблема перекосов~\cite{B_KostenetskyLS2007}. Суть проблемы заключается в следующем. При параллельной обработке запроса каждый агент обрабатывает свою часть запроса на отдельном процессорном узле. В этом случае возникает ситуация, когда один или несколько агентов завершают обработку, в то время как остальные (загруженные) агенты активно работают. Таким образом, при обработке запроса часть процессорных узлов может простаивать, что уменьшает эффект от распараллеливания и увеличивает время обработки запроса. Подобные ситуации могут возникать вследствие неоднородности процессорных узлов, при неравномерном распределении базы данных по процессорным узлам и т.д.
\parОдним из наиболее известных способов решения данной проблемы является использование алгоритмов балансировки загрузки, основанных на репликации базы данных. В работе~\cite{B_Lepikhov2006} в качестве стратегии репликации предлагается метод частичного зеркалирования. При использовании данной стратегии каждый фрагмент на логическом уровне разбивается на равномощные сегменты, являющиеся единицами репликации данных и балансировки загрузки. Фрагмент, расположенный на одном узле, частично реплицируется на остальных узлах многопроцессорной системы. Размер реплицируемой части фрагмента на каждом узле задается некоторым коэффициентом репликации. 
%\parОбщую схему алгоритма балансировки загрузки с использованием метода частичного зеркалирования можно описать следующим образом. При возникновении ситуации перекоса агент, выполнивший свою часть запроса (простаивающий), переходит в состояние простоя и выбирает наиболее загруженного агента. Загруженный агент получает от простаивающего агента предложение передать часть работы. Загруженный агент оценивает состояние обработки запроса и выделяет часть своего фрагмента  простаивающему агенту. При этом, если на узле простаивающего агента имеется реплика этого фрагмента, то пересылки по сети не требуются: простаивающий агент переходит в состояние выполнения и использует для обработки реплику фрагмента, используемого загруженным агентом. Таким образом, уменьшаются накладные расходы на передачу данных по сети, уменьшается время, затрачиваемое системой на операцию балансировки загрузки.
\parУказанный метод позволяет нейтрализовать негативный эффект ситуации перекоса: уменьшить время простоя процессорного узла и время обработки запроса.


\subsection{Общие требования к параллельной СУБД}\label{S_PDBMSRequirements}
\parПараллельная система управления базами данных (ПСУБД) представляет собой программную систему, которая предназначена для параллельной обработки запросов в распределенных вычислительных системах.

\parПСУБД поддерживает фрагментный параллелизм и имеет механизм балансировки загрузки, основанный на стратегии репликации, называемый методом частичного зеркалирования~\cite{B_Lepikhov2006}. Заложенный в ПСУБД параллелизм обработки запросов прозрачен для пользователя.

\parПСУБД поддерживает многопользовательский режим работы, т.е. одновременно система может обрабатывать запросы нескольких пользователей.
Для организации приема запросов от пользователей в ПСУБД использован реляционный язык запросов RQL (см. раздел~\ref{S_RQL}). Запрос, записанный на языке RQL, передается ПСУБД в виде текстового файла. После окончания обработки запроса ПСУБД передает пользователю \textit{результирующую таблицу} и \textit{лог-файл}.

\parРезультирующая таблица представляется в виде текстового файла в формате CSV (Comma Separated Value)~\cite{B_RFC4180}. Если результатом запроса является пустая таблица, то текстовый файл с результирующей таблицей будет пустым.
\parЛог-файл передается пользователю в виде текстового файла в формате CSV. Лог-файл содержит диагностические сообщения о ходе выполнения запроса. Структура и семантика сообщений лог-файла определены в разделе~\ref{S_LOG}.


\section{Структура ПСУБД}\label{S_PDBMSStructure}
\begin{figure}[!tb]
\begin{center}
\includegraphics[scale=0.48]{images/SysObjectDiagram.eps}\caption{Диаграмма объектов для случая с тремя Пользователями и двумя Ядрами ПСУБД}\label{fig:SysObjDiag}
\end{center}
\end{figure}
\parПараллельная СУБД состоит из объектов четырех классов: \textit{Пользователь} \textit{Клиент}, \textit{Координатор} и \textit{Ядро ПСУБД}.
Пример, демонстрирующий статическую структуру ПСУБД, показан на рис.~\ref{fig:SysObjDiag}. 
\parПользователь представляет собой человека, взаимодействующего с ПСУБД посредством Клиента, однако Клиент допускает вызов в формате командной строки и может быть использован программными системами, являющимися внешними по отношению к ПСУБД.
\parКлиент представляет собой подсистему ПСУБД, реализующую интерфейс Пользователя. Для каждого Пользователя ПСУБД порождается отдельный экземпляр Клиента. Поступающие от пользователя запросы Клиент передает Координатору, который обеспечивает совместную обработку запроса Ядрами ПСУБД.
\parОсновной задачей Координатора является доставка запроса от Клиента на Ядра ПСУБД. Координатор принимает запрос от каждого обратившегося к нему Клиента и передает его Ядрам ПСУБД, которые будут выполнять обработку данного запроса. В рамках рассматриваемого примера совместная обработка запросов осуществляется двумя Ядрами ПСУБД и управляется одним Координатором. В целях повышения производительности в распределенной вычислительной системе может быть запущено несколько Координаторов. В таком случае Клиент может обращаться с запросами к любому доступному Координатору. Необходимость введения дополнительного Координатора может возникать, например, при увеличении количества Клиентов или объемов поступающих от Ядер ПСУБД результатов.
\parЯдро ПСУБД непосредственно выполняет обработку запроса и передает результат тому Координатору, от которого поступил запрос.

\begin{figure}[!t]
\begin{center}
\includegraphics[scale=0.48]{images/SysDeployDiagram.eps}\caption{Диаграмма размещения подсистем ПСУБД для случая с тремя Пользователями и двумя Ядрами ПСУБД}\label{fig:SysDeplDiag}
\end{center}
\end{figure}
\parНа рис.~\ref{fig:SysDeplDiag} показана типовая конфигурация размещения подсистем ПСУБД. Клиент запускается на рабочей станции пользователя (в данной кофигурации на консоли). Если с ПСУБД на одной рабочей станции взаимодействует несколько пользователей, то для каждого пользователя на данной рабочей станции запускается отдельный экземпляр Клиента.
\parКоординатор размещается в распределенной вычислительной системе на выделенном узле (хост-машине). Координатор взаимодействует с Клиентами через локальную коммуникационную сеть (в данном случае Ethernet). Координатор взаимодействует с ядрами через  коммуникационную сеть (в данном случае Infiniband). Ядро ПСУБД размещается на выделенном ему процессорном узле. Процессорные узлы системы соединяются между собой коммуникационной сетью (Infiniband).

\subsection{Подсистема "<Клиент">}\label{S_Client}
\begin{figure}[!tb]
\begin{center}
\includegraphics[scale=0.48]{images/clientStateDiagram.eps}\caption{Диаграмма состояний подсистемы "<Клиент">}\label{fig:ClientStateDiag}
\end{center}
\end{figure}

\parКлиент предоставляет пользователю интерфейс доступа к ПСУБД: обеспечивает передачу запросов ПСУБД, мониторинг процесса обработки запроса и доступ к результату его выполнения. В каждый момент времени Клиент может обрабатывать только один запрос пользователя. Клиент может использоваться в диалоговом и пакетном режимах. При использовании Клиента в диалоговом режиме пользователю предоставляется диалоговое окно, основными элементами которого являются строка ввода запроса, область просмотра результата и область просмотра диагностических сообщений. В пакетном режиме работы Клиенту передается имя файла с запросом и имя файла, в который будет записана результирующая таблица.
\parНа рис.~\ref{fig:ClientStateDiag} показана диаграмма состояний Клиента. Клиент может находиться в одном из семи состояний: "<Ожидание запроса">, "<Выполнение запроса">, "<Сохранение результата">, "<Сохранение лог-файла">, "<Прием сообщения">, "<Прием результата">, и "<Прерывание запроса">.
\parРабочий цикл Клиента начинается с состояния "<Ожидание запроса">, в котором Клиент ожидает команд от Пользователя. Из данного состояния Клиент может перейти в состояние "<Выполнение запроса">, "<Сохранение результата"> или "<Сохранение лог-файла">.  Пользователь может также корректно завершить Клиента, вызвав функцию "<Завершить работу">.
\parВ состоянии "<Выполнение запроса"> Клиент ожидает результатов обработки запроса от Координатора. При поступлении от Координатора результирующей таблицы или диагностического сообщения, Клиент переходит в состояние "<Прием результата"> или "<Прием сообщения"> соответственно. Пользователь может спровоцировать прерывание обработки запроса, вызвав функцию Клиента "<Прервать">. При этом, Клиент переходит в состояние "<Прерывание запроса">. 
\parВ состоянии "<Сохранение результата"> Клиент помещает результирующую таблицу в заданный пользователем файл. При нормальном завершении операции Клиент переходит в состояние "<Ожидание запроса">.
\parВ состоянии "<Сохранение лог-файла"> Клиент помещает полученные в ходе обработки запроса диагностические сообщения в указанный пользователем лог-файл. При нормальном завершении операции Клиент переходит в состояние "<Ожидание запроса">.
\parВ состоянии "<Прием сообщения"> Клиент принимает диагностическое сообщение от Координатора Если  полученное сообщение уведомляет об окончании обработки запроса, то Клиент переходит в состояние "<Ожидание запроса">. В противном случае он переходит в состояние "<Выполнение запроса">.
\parВ состоянии "<Прием результата"> Клиент принимает результирующую таблицу от Координатора. При нормальном завершении операции Клиент переходит в состояние "<Ожидание запроса">.
\parВ состоянии "<Прерывание запроса"> Клиент передает Координатору сообщение о прерывании обработки запроса. Если сообщение удается передать Координатору, прерывание запроса заканчивается успешно и Клиент переходит в состояние "<Ожидание запроса">. Если Координатор оказывается недоступен, Клиент переходит в состояние "<Выполнение запроса">.

\subsection{Подсистема "<Координатор">}\label{S_Coordinator}
\parКоординатор организует параллельное выполнение запроса на множестве Ядер ПСУБД. При этом, одно Ядро ПСУБД одновременно может обрабатывать несколько запросов. Координатор может взаимодействовать с несколькими Клиентами. Во время работы Координатор ведет лог-файл, в который заносятся диагностические сообщения о работе Координатора.

\subsection{Подсистема "<Ядро ПСУБД">}\label{S_Kernel}
\parЯдро ПСУБД работает на отдельном SMP-узле и выполняет обработку поступающих запросов в асинхронном режиме. На одном SMP-узле может работать только одно Ядро ПСУБД. Ядро ПСУБД поддерживает межтранзакционный параллелизм, т.е. одновременно может обрабатывать несколько запросов.

\section{Модель вариантов использования}\label{S_UseCaseModel}
\parВ данном разделе приведены варианты использования подсистем "<Клиент"> и "<Координатор">. Вариант использования  описывается в соответствии со следующей дисциплиной. Во-первых, приводится краткое описание варианта использования и предварительные условия, необходимые для начала его выполнения. Во-вторых, приводится описание основных шагов, составляющих поток событий варианта использования. В-третьих, обсуждаются альтернативные потоки событий, приводятся дополнительные требования.

\subsection{Варианты использования подсистемы "<Клиент">}\label{S_ClientUseCase}
\begin{figure}[!tb]
\begin{center}
\includegraphics[scale=0.48]{images/ClientUCDiagram.eps}\caption{Диаграмма вариантов использования подсистемы "<Клиент">}\label{fig:ClientUCDiag}
\end{center}
\end{figure}
Для подсистемы "<Клиент"> нами выделяются следующие варианты использования, приведенные на рис.~\ref{fig:ClientUCDiag}: \textit{"<Выполнить">}, \textit{"<Прервать">}, \textit{"<Передать сообщение">}, \textit{"<Пополнить результат">}, \textit{"<Сохранить результат">}, \textit{"<Сохранить лог-файл">} и \textit{"<Завершить работу">}. Варианты использования предусматривают диалоговый и пакетный режимы работы Клиента. Далее в этом разделе приводится детальное описание каждого варианта использования.

\subsubsection{Вариант использования "<Выполнить">}
Данный вариант использования передает запрос от Пользователя к Координатору. Вариант использования начинается, когда Пользователь указывает путь к текстовому файлу с запросом и активирует функцию "<Выполнить">. При этом Клиент должен находиться в состоянии ожидания запроса и текстовый файл с запросом должен существовать на узле Клиента.
\parПоток событий состоит из следующих шагов. На первом шаге Клиент переходит в состояние "<Выполнение запроса"> и подготавливает систему к обработке запроса: очищает область просмотра результирующей таблицы, очищает область просмотра сообщений, формирует пустой файл результата и пустой лог-файл. На втором шаге Клиент передает текстовый файл с запросом Координатору. Вариант использования завершается.
\parВариант использования предусматривает один альтернативный поток событий. Если попытка Клиента передать запрос Координатору завершается неудачей, то Клиент выводит в области просмотра соответствующее сообщение об ошибке, записывает его в лог-файл и переходит в состояние "<Ожидание запроса">. Вариант использования завершается.

\subsubsection{Вариант использования "<Прервать">}
Данный вариант использования осуществляет прерывание выполнения запроса (досрочное завершение) по требованию Пользователя.  Вариант использования начинается, когда Пользователь вызывает функцию "<Прервать">. При этом Клиент должен находиться в состоянии "<Выполнение запроса">.
\parПоток событий состоит из следующих шагов. На первом шаге Клиент переходит в состояние вывода сообщения и посылает Координатору сообщение "<Прервать">. Если передача сообщения завершается успешно, то на втором шаге Клиент формирует сообщение о досрочном прерывании запроса, выводит его в области просмотра сообщений и записывает в лог-файл. На последнем шаге Клиент переходит в состояние "<Ожидание запроса">. Вариант использования завершается.
\parЕсли попытка Клиента передать сообщение Координатору завершается неудачей, то он формирует сообщение об ошибке, выводит его в области просмотра и записывает в лог-файл. После этого Клиент переходит в состояние "<Выполнение запроса">. Вариант использования завершается.

\subsubsection{Вариант использования "<Передать сообщение">}
Данный вариант использования уведомляет Клиента о возникновении некоторого существенного события в ходе выполнения запроса. Вариант использования начинается, когда Координатор вызывает функцию "<Передать сообщение">. При этом Клиент должен находиться в состоянии "<Выполнение запроса">.
\parПоток событий состоит из следующих шагов. На первом шаге Клиент переходит в состояние "<Прием сообщения"> и получает от Координатора диагностическое сообщение. На втором шаге Клиент выводит полученное сообщение в области просмотра сообщений и записывает его в лог-файл. На третьем шаге Клиент переходит в состояние "<Выполнение запроса">. Вариант использования завершается.
\parВариант использования предусматривает альтернативный поток событий. Если Клиент на первом шаге получает от Координатора сообщение с кодом фатальной ошибки или кодом, соответствующим нормальному завершению, то выполняется следующая последовательность шагов. На первом шаге Клиент выводит полученное сообщение в области просмотра сообщений и записывает его в лог-файл. На втором шаге Клиент переходит в состояние "<Ожидание запроса">, после чего вариант использования завершается.

\subsubsection{Вариант использования "<Пополнить результат">}
Данный вариант использования передает очередную часть результирующей таблицы от Координатора Клиенту. Вариант использования начинается, когда Координатор вызывает функцию "<Пополнить результат">.
\parПоток событий состоит из следующих шагов. На первом шаге Клиент переходит в состояние "<Прием результата"> и принимает от Координатора очередную часть результирующей таблицы. На втором шаге Клиент выводит полученную часть результирующей таблицы в области просмотра результата и записывает ее в результирующий файл. На третьем шаге Клиент переходит в состояние выполнения запроса. Вариант использования завершается.

\subsubsection{Вариант использования "<Сохранить результат">}
Данный вариант использования помещает результат запроса в текстовый файл в формате CSV. Вариант использования начинается, когда Пользователь вызывает функцию "<Сохранить результат">. При этом Клиент должен находиться в состоянии ожидания нового запроса.
\parПоток событий состоит из следующих шагов. На первом шаге Клиент переходит в состояние "<Сохранение результата">, получает от Пользователя имя файла, в который будет помещена результирующая таблица. На втором шаге Клиент сохраняет результирующую таблицу в текстовом файле, указанном пользователем, в формате~CSV. На третьем шаге Клиент переходит в состояние "<Ожидание запроса">. Вариант использования завершается.
\parПолученная Клиентом результирующая таблица хранится во временном файле до тех пор, пока Пользователь не запустит выполнение нового запроса.

\subsubsection{Вариант использования "<Сохранить лог-файл">}
Данный вариант использования сохраняет лог-файл запроса в текстовом файле в формате~CSV. Вариант использования начинается, когда Пользователь вызывает функцию "<Сохранить лог-файл">. При этом Клиент должен находиться в состоянии "<Ожидание запроса">.
\parПоток событий состоит из следующих шагов. На первом шаге Клиент переходит в состояние "<Сохранение лог-файла">, запрашивает у Пользователя путь и имя файла для сохранения лог-файла. На втором шаге Клиент сохраняет лог-файл в текстовом файле, указанном пользователем. На третьем шаге Клиент переходит в состояние "<Ожидание запроса">. Вариант использования завершается.
\parПолученные Клиентом от Координатора сообщения хранятся во временном файле до тех пор, пока Пользователь не запустит выполнение нового запроса.

\subsubsection{Вариант использования "<Завершить работу">}
Данный вариант использования завершает сеанс работы Пользователя с ПСУБД. Вариант использования начинается, когда Пользователь вызывает функцию "<Завершить работу">. При этом Клиент должен находиться в состоянии "<Ожидание запроса">.
\parПоток событий состоит из следующих шагов. На первом шаге Клиент освобождает используемые структуры данных. На втором шаге Клиент завершает свою работу (возвращает поток управления операционной системе). Вариант использования завершается.

\subsection{Варианты использования подсистемы "<Координатор">}\label{S_CoordinatorUseCases}

\begin{figure}[!tb]
\begin{center}
\includegraphics[scale=0.48]{images/CoordUCDiagram.eps}\caption{Диаграмма вариантов использования подсистемы "<Координатор">}\label{fig:CoordUCDiag}
\end{center}
\end{figure}
Для подсистемы "<Координатор"> нами были разработаны следующие варианты использования, приведенные на рис.~\ref{fig:CoordUCDiag}: \textit{"<Передать запрос">}, \textit{"<Передать результат">}, \textit{"<Передать cообщение">}, \textit{"<Прервать">}. Координатор взаимодействует с множеством Клиентов и должен представлять собой систему высокой готовности. Поэтому варианты использования спроектированы таким образом, чтобы максимально уменьшить время отклика Координатора. Далее в этом разделе приводится детальное описание каждого варианта использования.

\subsubsection{Вариант использования "<Передать запрос">}
\parПередает запрос Ядрам ПСУБД для дальнейшей обработки. Вариант использования начинается, когда Клиент вызывает функцию "<Передать запрос">.
\parПоток событий состоит из следующих шагов. На первом шаге Координатор получает запрос от Клиента как параметр функции "<Передать запрос">. На втором шаге Координатор панализирует файл конфигурации ПСУБД и формирует список Ядер ПСУБД, которые будут выполнять запрос. На третьем шаге Координатор передает запрос Ядрам ПСУБД в асинхронном режиме. Вариант использования завершается.

\subsubsection{Вариант использования "<Передать результат">}
\parПередает результирующую таблицу, выдаваемую Ядром ПСУБД, Клиенту. Вариант использования начинается, когда Ядро ПСУБД вызывает функцию "<Передать результат">.
\parПоток событий состоит из следующей последовательности шагов. На первом шаге Координатор получает результирующую таблицу в виде текстового файла от Ядра ПСУБД в синхронном режиме. На втором шаге Координатор определяет Клиента, который запустил данный запрос и вызывает функцию "<Пополнить результат"> (передает Клиенту файл с результатом, полученный от Ядра ПСУБД). Вариант использования завершается.
\parВариант использования включает в себя следующие два альтернативных потока.
\parЕсли на шаге 2 основного потока Координатору не удается передать результирующую таблицу Клиенту, то выполняются следующие действия. На первом шаге Координатор записывает в лог-файл сообщение "<Клиент недоступен">. На втором шаге Координатор вызывает функцию "<Прервать">. Вариант использования завершается.
\parЕсли на шаге 2 основного потока Координатор обнаруживает, что Клиент прервал выполнение запроса, то Координатор удаляет результирующую таблицу и вариант использования завершается.

\subsubsection{Вариант использования "<Передать сообщение">}
\parУведомляет Координатор о возникновении некоторого существенного события, произошедшего с Ядром ПСУБД. Вариант использования начинается, когда Ядро ПСУБД вызывает функцию "<Передать сообщение">.
\parОсновной поток событий состоит из следующей последовательности шагов. На первом шаге Координатор получает сообщение от Ядра ПСУБД. На втором шаге Координатор интерпретирует полученное сообщение и формирует диагностическое сообщение для клиента. На последнем шаге Координатор передает данное диагностическое сообщение Клиенту. Вариант использования завершается.
\parВариант использования включает в себя три альтернативных потока.
\parЕсли Координатору на третьем шаге основного потока событий не удается передать диагностическое сообщение Клиенту, то начинается выполнение альтернативного потока, состоящего из следующих шагов. На первом шаге Координатор помещает в лог-файл,  сообщение "<Клиент недоступен">. На втором шаге Координатор вызывает функцию "<Прервать">. Выполнение варианта использования завершается.
\parЕсли на шаге 2 основного потока Координатор обнаруживает, что получено сообщение "<Обработка запроса завершена"> то выполняется следующая последовательность шагов. На первом шаге Координатор удаляет ядро из списка Ядер ПСУБД, выполняющих данный запрос. На втором шаге Координатор передает Клиенту диагностическое сообщение о том, что Ядро ПСУБД завершило обработку запроса. Вариант использования завершается.
\parЕсли на шаге 1 альтернативного потока 2 Координатор обнаруживает, что список Ядер ПСУБД, обрабатывающих запрос, пуст, то выполняется следующая последовательность шагов. На первом шаге Координатор передает Клиенту  диагностическое сообщение о том, что Ядро ПСУБД завершило обработку запроса. На втором шаге Координатор передает Клиенту диагностическое сообщение "<Обработка запроса завершена">. Вариант использования завершается.

\subsubsection{Вариант использования "<Прервать">}
\parОстанавливает выполнение запроса на ядрах ПСУБД по требованию Клиента. Вариант использования начинается, когда Клиент вызывает функцию "<Прервать">.
\parОсновной поток событий состоит из следующей последовательности шагов. На первом шаге Координатор получает от Клиента сообщение "<Прервать">. На втором шаге Координатор посылает всем ядрам ПСУБД, задействованным в обработке запроса, сообщение "<Прервать">. Вариант использования завершается.


\section{Форматы входных и выходных данных}\label{S_InOutData}
\subsection{Спецификация языка RQL}\label{S_RQL}
\parЯзык запросов RQL (Relational Query Language) базируется на реляционной алгебре. Описанная здесь нотация включает в себя операции простой выборки и эквисоединения. Простая выборка (\texttt{Restrict}) допускает только условия следующего вида: \texttt{<Атрибут> <Операция сравнения> <Константа>}. Операция эквисоединения (\texttt{eQuijoin}) выполняет соединение по равенству одной пары атрибутов. Предложенная нотация может быть легко распространена на другие реляционные операции.
\parВ качестве разделителя лексем могут использоваться пробелы, символы табуляции, перевода строки и возврата каретки в любом количестве и сочетании.
\parГрамматика языка RQL, описанная с помощью нотации Бэкуса-Наура представлена ниже:\\
\texttt{<Запрос> ::= <Оператор>\\
<Запрос> ::= <Запрос>;<Оператор>\\
<Оператор> ::= <Метка> <Реляционная операция>\\
<Реляционная операция> ::= <Выборка> | <Эквисоединение>\\
<Выборка> ::= R <Условие> <Таблица>\\
<Условие>::= <Номер атрибута> <Операция сравнения> <Константа>\\
<Эквисоединение> ::= Q <Номер атрибута> <Номер атрибута> <Таблица> <Таблица>\\
<Таблица> ::= <Метка> | <Идентификатор хранимой таблицы>\\
<Метка> ::= <Целое без знака>\\
<Номер атрибута> ::= <Целое без знака>\\
<Операция сравнения> ::= > | < | = <Идентификатор хранимой таблицы> ::= \#<Целое без знака>
}
\subsection{Спецификация лог-файла}\label{S_LOG}
Лог-файл содержит диагностические сообщения, выдаваемые ядрами ПСУБД.
В качестве разделителя лексем могут использоваться пробелы, символы табуляции, перевода строки и возврата каретки в любом количестве и сочетании. Описание структуры лог-файла в нотации Бэкуса-Наура представлена ниже:\\
\texttt{<Лог-файл> ::= <Сообщение>\{<Сообщение>\}\\
<Сообщение> ::= <Ядро> <Результат> <Комментарий>\\
<Ядро> ::= <Целое без знака>\\
<Результат> ::= <Целое без знака>\\
<Комментарий> ::= <Строка>
}


\section{Заключение}\label{S_Conclusion}
\parВ данной работе были описаны спецификации параллельной системы управления базами данных для распределенных грид-систем. Спецификации разрабатывались при помощи модели вариантов использования на базе языка моделирования UML 2.0.
В качестве введения в тематику параллельных СУБД был рассмотрен механизм параллельной обработки запросов, в основе которого лежит фрагментация базы данных по узлам распределенной вычислительной системы. Была рассмотрена проблема возникновения перекосов и возможные методы ее устранения. Описаны основные требования к параллельным СУБД.
\parПодробно рассмотрена структура ПСУБД, представлены основные подсистемы и схема их взаимодействия. Для описания структуры ПСУБД были разработаны диаграмма объектов и диаграмма размещения. Комментарии к диаграммам подробно описывают структуру ПСУБД и конфигурацию размещения подсистем на процессорных узлах распределенной вычислительной системы. Для уточнения рабочего цикла подсистемы "<Клиент"> была разработана диаграмма состояний. Для каждого состояния приведены комментарии, описывающие его назначение и условия перехода в другие состояния.
\parДетально описаны варианты использования для подсистем "<Клиент"> и "<Координатор">. Приведены диаграммы вариантов использования данных подсистем. Представлены форматы входных и выходных данных параллельной ПСУБД.
\vspace{12pt}
\par{\it Работа выполнена при финансовой поддержке Российского фонда фундаментальных исследований (проект 06-07-89148).}


% оформление библиографии
\begin{biblio}
\bibitem{B_Gray2005} {\bf Gray J.} {\sf Query Evaluation Techniques for Large Databases} / J. Gray // ACM Computing Surveys.--1993. --Vol. 25, \No{2}. --P. 73--169.\vspace{-2mm}

\bibitem{B_Mehta1997} {\bf Mehta M.} {\sf Data Placement in Shared-Nothing Parallel Database Systems} / M. Mehta, D.J. DeWitt // The VLDB Journal. --1997. --Vol. 6, \No{1}. --P. 53--72.\vspace{-2mm}

\bibitem{B_Williams1998} {\bf Williams M.H.} {\sf Data Placement in Parallel Database Systems} / M.H. Williams, S. Zhou // Parallel Database Techniques. --1998. --P. 203--218.\vspace{-2mm}

\bibitem{B_Rambaugh1994} {\bf Rumbaugh J.} {\sf Getting started - Using Use Cases to Capture Requirements} / J. Rumbaugh // Journal of Object Oriented Programming. --1994 --vol.~7, \No{5} --P. 8--12.\vspace{-2mm}

\bibitem{B_Selic2006_UML2} {\bf Selic B.} {\sf UML 2: a model-driven development tool} / B. Selic // IBM Syst. J. --2006. --Vol.~45, \No{3}. --P. 607--620.\vspace{-2mm}

%\bibitem{B_Sokolinsky2004} {\bf Соколинский Л.Б.} {\sf Обзор архитектур параллельных систем баз данных} / Л.Б. Соколинский // Программирование. --2004. \No{6} --С. 49--63\vspace{-2mm}

\bibitem{B_Sokolinsky2001} {\bf Соколинский Л.Б.} {\sf Организация параллельного выполнения запросов в многопроцессорной машине баз данных с иерархической архитектурой} / Л.Б. Соколинский // Программирование. --2001. \No{6}. --С. 13--29.\vspace{-2mm}

\bibitem{B_Aloisio2005} {\bf Aloisio G.} {\sf The Grid-DBMS: Towards Dynamic Data Management in Grid Environments} / G. Aloisio, M. Cafaro, S. Fiore, M. Mirto // Proceedings of the International Conference on Information Technology: Coding and Computing (ITCC'05). --2005. --Vol. 2. --P. 199--204.\vspace{-2mm}

\bibitem{B_Dutra2004} {\bf Dutra M.L.} {\sf An adaptive parallel query processing middleware for the grid} / DaSilva V.F., Dutra M.L., Porto F., Schulze B., Barbosa A. C., de Oliveira J.C. // Concurr. Comput. : Pract. Exper. --2006. --Vol.~18, \No{6}. --P. 621--634.\vspace{-2mm}

\bibitem{B_KostenetskyLS2007} {\bf Костенецкий П.С.} {\sf Технологии параллельных систем баз данных для иерархических многопроцессорных сред} / П.С. Костенецкий, А.В. Лепихов, Л.Б. Соколинский // Автоматика и телемеханика. --2007. --Том 68, \No{5}. --C. 847--859.\vspace{-2mm}

\bibitem{B_Lepikhov2006} {\bf Лепихов А.В.} {\sf Стратегия размещения данных в многопроцессорных системах с симметричной иерархической архитектурой} / Лепихов А.В., Соколинский Л.Б. // Научный сервис в сети Интернет: технологии параллельного программирования: тр. Всерос. науч. конф. (18-23 сентября 2006 г., г. Новороссийск). --М., 2006. --С. 39--42.\vspace{-2mm}

\bibitem{B_RFC4180} {\bf RFC4180:} {\sf Common Format and MIME Type for Comma-Separated Values (CSV) Files:}\\ (http://tools.ietf.org/html/rfc4180), October 2005. \vspace{-2mm}

\end{biblio}

\end{document}


\address{Кафедра системного программирования, \\ ЮУрГУ \\ lepihov@susu.ru}
\author{A.V. Lepikhov}

\title{Use Case Model of Parallel Database Management System for Grid Architectures}
% Для построения заголовка статьи используйте команду \maketitle{}
\maketitle{}
\begin{abstract} \begin{tabular}{p{20mm}p{119mm}}
&\noindent {\footnotesize \qquad 
This paper is dedicated to design of parallel database management systems for grid environments. General requirements and parallel DBMS structure is described, use case model of the system is presented. Specifications and use case diagrams for subsystems "<Client"> and "<Coordinator"> is showed.
}
\end{tabular}\end{abstract}

\keywordsanglish{Use Case, Parallel Database System, Grid, Parallel Processing}
